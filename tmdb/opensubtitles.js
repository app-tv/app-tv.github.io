!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.PluginRegistry=e():(t.PluginRegistry=t.PluginRegistry||{},t.PluginRegistry.opensubtitles=e())}(self,(function(){return function(){"use strict";var t={};(function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})})(t);var e="https://api.opensubtitles.com/api/v1";function n(t){for(var e="",n=t.split(/\n/);n.length>3;){for(var r=3;r<n.length;r++)n[2]+="\n"+n[r];n.splice(3,n.length-3)}var o=0;if(!n[0].match(/\d+:\d+:\d+/)&&n[1].match(/\d+:\d+:\d+/)&&(e+=n[0].match(/\w+/)+"\n",o+=1),!n[o].match(/\d+:\d+:\d+/))return"";var i=n[1].match(/(\d+):(\d+):(\d+)(?:,(\d+))?\s*--?>\s*(\d+):(\d+):(\d+)(?:,(\d+))?/);return i?(e+=i[1]+":"+i[2]+":"+i[3]+"."+i[4]+" --\x3e "+i[5]+":"+i[6]+":"+i[7]+"."+i[8]+"\n",n[o+=1]&&(e+=n[o]+"\n\n"),e):""}return window.App.customSubtitles=function(t,r,o){var i=[];return function(t,n,r){var o={Accept:"*/*","Api-Key":"tHehXGn0Bd7rsyJBD5a641hOqwWNTk9s","User-Agent":"PostmanRuntime/7.29.0","Content-Type":"application/json"},i=e+"/subtitles?";return r&&(i+="episode_number="+r+"&"),i+="imdb_id="+(t.replace("tt","")-0)+"&languages=et",n&&(i+="&season_number="+n),fetch(i,{headers:o}).then((function(t){return t.json()})).then((function(t){var e,n;return null===(e=t.data[0])||void 0===e||null===(n=e.attributes.files[0])||void 0===n?void 0:n.file_id})).then((function(t){var n=JSON.stringify({file_id:t});return fetch(e+"/download",{method:"POST",headers:o,body:n}).then((function(t){return t.json()})).then((function(t){return null==t?void 0:t.link}))})).catch((function(t){return null}))}(t.external_ids.imdb_id,r,o).then((function(t){return t?function(t){return fetch(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).then((function(t){return t.text()}))}(t).then((function(t){return function(t){return fetch(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).then((function(t){return t.json()}))}("https://cors.eu.org/https://www.toptal.com/developers/hastebin/documents",{method:"POST",body:function(t){var e=t.replace(/\r+/g,"").replace(/^\s+|\s+$/g,"").split("\n\n"),r="";if(e.length>0){r+="WEBVTT\n\n";for(var o=0;o<e.length;o+=1)r+=n(e[o])}return r}(t)}).then((function(t){var e=t.key;return i.push({label:"Estonian",url:"https://cors.eu.org/https://www.toptal.com/developers/hastebin/raw/"+e}),i})).catch((function(t){return i}))})):i}))},t.default={name:"opensubtitles"},t}()}));
//# sourceMappingURL=opensubtitles.js.map