!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.PluginRegistry=e():(t.PluginRegistry=t.PluginRegistry||{},t.PluginRegistry.opensubtitles=e())}(self,(function(){return function(){"use strict";var t={};(function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})})(t);var e="https://api.opensubtitles.com/api/v1";function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(t,e).then((function(t){return t.text()}))}function r(t){for(var e="",n=t.split(/\n/);n.length>3;){for(var r=3;r<n.length;r++)n[2]+="\n"+n[r];n.splice(3,n.length-3)}var i=0;if(!n[0].match(/\d+:\d+:\d+/)&&n[1].match(/\d+:\d+:\d+/)&&(e+=n[0].match(/\w+/)+"\n",i+=1),!n[i].match(/\d+:\d+:\d+/))return"";var o=n[1].match(/(\d+):(\d+):(\d+)(?:,(\d+))?\s*--?>\s*(\d+):(\d+):(\d+)(?:,(\d+))?/);return o?(e+=o[1]+":"+o[2]+":"+o[3]+"."+o[4]+" --\x3e "+o[5]+":"+o[6]+":"+o[7]+"."+o[8]+"\n",n[i+=1]&&(e+=n[i]+"\n\n"),e):""}return window.App.customSubtitles=function(t,i,o){var u=[];return function(t,n,r){var i={Accept:"*/*","Api-Key":"tHehXGn0Bd7rsyJBD5a641hOqwWNTk9s","User-Agent":"PostmanRuntime/7.29.0","Content-Type":"application/json"},o=e+"/subtitles?";return r&&(o+="episode_number="+r+"&"),o+="imdb_id="+(t.replace("tt","")-0)+"&languages=et",n&&(o+="&season_number="+n),fetch(o,{headers:i}).then((function(t){return t.json()})).then((function(t){var e,n;return null===(e=t.data[0])||void 0===e||null===(n=e.attributes.files[0])||void 0===n?void 0:n.file_id})).then((function(t){var n=JSON.stringify({file_id:t});return fetch(e+"/download",{method:"POST",headers:i,body:n}).then((function(t){return t.json()})).then((function(t){return null==t?void 0:t.link}))})).catch((function(t){return null}))}(t.external_ids.imdb_id,i,o).then((function(t){return t?n(t).then((function(t){var e=function(t){var e=t.replace(/\r+/g,"").replace(/^\s+|\s+$/g,"").split("\n\n"),n="";if(e.length>0){n+="WEBVTT\n\n";for(var i=0;i<e.length;i+=1)n+=r(e[i])}return n}(t);return n("https://cors.eu.org/https://pastebin.com/api/api_post.php",{method:"POST",body:new URLSearchParams({api_paste_code:e,api_paste_expire_date:"10M",api_paste_private:"1",api_dev_key:"hny_ursrah236uf1E6u3BLU2zaPcRIEg",api_option:"paste"})}).then((function(t){return u.push({label:"Estonian",url:"https://cors.eu.org/"+t.replace("https://pastebin.com","https://pastebin.com/raw")}),u})).catch((function(t){return u}))})):u}))},t.default={name:"opensubtitles"},t}()}));
//# sourceMappingURL=opensubtitles.js.map